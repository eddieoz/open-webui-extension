var we=Object.defineProperty;var me=(e,t,l)=>t in e?we(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l;var q=(e,t,l)=>(me(e,typeof t!="symbol"?t+"":t,l),l);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function l(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(o){if(o.ep)return;o.ep=!0;const r=l(o);fetch(o.href,r)}})();function B(){}function ne(e){return e()}function W(){return Object.create(null)}function T(e){e.forEach(ne)}function oe(e){return typeof e=="function"}function re(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function pe(e){return Object.keys(e).length===0}function w(e,t){e.appendChild(t)}function L(e,t,l){e.insertBefore(t,l||null)}function I(e){e.parentNode&&e.parentNode.removeChild(e)}function he(e,t){for(let l=0;l<e.length;l+=1)e[l]&&e[l].d(t)}function p(e){return document.createElement(e)}function V(e){return document.createTextNode(e)}function C(){return V(" ")}function ge(){return V("")}function M(e,t,l,n){return e.addEventListener(t,l,n),()=>e.removeEventListener(t,l,n)}function u(e,t,l){l==null?e.removeAttribute(t):e.getAttribute(t)!==l&&e.setAttribute(t,l)}function _e(e){return Array.from(e.childNodes)}function ye(e,t){t=""+t,e.data!==t&&(e.data=t)}function S(e,t){e.value=t??""}function Z(e,t,l){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t){o.selected=!0;return}}(!l||t!==void 0)&&(e.selectedIndex=-1)}function ve(e){const t=e.querySelector(":checked");return t&&t.__value}let H;function $(e){H=e}function be(){if(!H)throw new Error("Function called outside component initialization");return H}function xe(e){be().$$.on_mount.push(e)}const j=[],Y=[];let O=[];const G=[],ke=Promise.resolve();let U=!1;function Me(){U||(U=!0,ke.then(se))}function z(e){O.push(e)}const D=new Set;let A=0;function se(){if(A!==0)return;const e=H;do{try{for(;A<j.length;){const t=j[A];A++,$(t),Ce(t.$$)}}catch(t){throw j.length=0,A=0,t}for($(null),j.length=0,A=0;Y.length;)Y.pop()();for(let t=0;t<O.length;t+=1){const l=O[t];D.has(l)||(D.add(l),l())}O.length=0}while(j.length);for(;G.length;)G.pop()();U=!1,D.clear(),$(e)}function Ce(e){if(e.fragment!==null){e.update(),T(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(z)}}function Ee(e){const t=[],l=[];O.forEach(n=>e.indexOf(n)===-1?t.push(n):l.push(n)),l.forEach(n=>n()),O=t}const N=new Set;let Se;function ie(e,t){e&&e.i&&(N.delete(e),e.i(t))}function Ie(e,t,l,n){if(e&&e.o){if(N.has(e))return;N.add(e),Se.c.push(()=>{N.delete(e)}),e.o(t)}}function J(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function Le(e){e&&e.c()}function de(e,t,l){const{fragment:n,after_update:o}=e.$$;n&&n.m(t,l),z(()=>{const r=e.$$.on_mount.map(ne).filter(oe);e.$$.on_destroy?e.$$.on_destroy.push(...r):T(r),e.$$.on_mount=[]}),o.forEach(z)}function ce(e,t){const l=e.$$;l.fragment!==null&&(Ee(l.after_update),T(l.on_destroy),l.fragment&&l.fragment.d(t),l.on_destroy=l.fragment=null,l.ctx=[])}function Ae(e,t){e.$$.dirty[0]===-1&&(j.push(e),Me(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ue(e,t,l,n,o,r,i=null,s=[-1]){const m=H;$(e);const d=e.$$={fragment:null,ctx:[],props:r,update:B,not_equal:o,bound:W(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(m?m.$$.context:[])),callbacks:W(),dirty:s,skip_bound:!1,root:t.target||m.$$.root};i&&i(d.root);let h=!1;if(d.ctx=l?l(e,t.props||{},(a,c,...v)=>{const f=v.length?v[0]:c;return d.ctx&&o(d.ctx[a],d.ctx[a]=f)&&(!d.skip_bound&&d.bound[a]&&d.bound[a](f),h&&Ae(e,a)),c}):[],d.update(),h=!0,T(d.before_update),d.fragment=n?n(d.ctx):!1,t.target){if(t.hydrate){const a=_e(t.target);d.fragment&&d.fragment.l(a),a.forEach(I)}else d.fragment&&d.fragment.c();t.intro&&ie(e.$$.fragment),de(e,t.target,t.anchor),se()}$(m)}class ae{constructor(){q(this,"$$");q(this,"$$set")}$destroy(){ce(this,1),this.$destroy=B}$on(t,l){if(!oe(l))return B;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(l),()=>{const o=n.indexOf(l);o!==-1&&n.splice(o,1)}}$set(t){this.$$set&&!pe(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const je="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(je);const Q=async(e,t)=>{var l;try{if(typeof chrome>"u"||!chrome.runtime)throw new Error("Chrome extension API not available");const n=await chrome.runtime.sendMessage({action:"fetchModels",key:e,url:t});if(!n.success)throw new Error(n.error);let o=((l=n.data)==null?void 0:l.data)??[];return o=o.filter(r=>r).sort((r,i)=>{const s=r.name.toLowerCase(),m=i.name.toLowerCase();return s<m?-1:s>m?1:r<i?-1:r>i?1:0}),console.log(o),o}catch(n){throw console.log(n),n}};function X(e,t,l){const n=e.slice();return n[6]=t[l],n}function ee(e){let t,l,n;function o(s,m){return s[1]?Be:Oe}let r=o(e),i=r(e);return{c(){t=p("div"),i.c(),u(t,"class","tlwd-fixed tlwd-top-0 tlwd-right-0 tlwd-left-0 tlwd-bottom-0 tlwd-w-full tlwd-min-h-screen tlwd-h-screen tlwd-flex tlwd-justify-center tlwd-z-[9999999999] tlwd-overflow-hidden tlwd-overscroll-contain")},m(s,m){L(s,t,m),i.m(t,null),l||(n=M(t,"mousedown",e[15]),l=!0)},p(s,m){r===(r=o(s))&&i?i.p(s,m):(i.d(1),i=r(s),i&&(i.c(),i.m(t,null)))},d(s){s&&I(t),i.d(),l=!1,n()}}}function Oe(e){let t,l,n,o,r,i,s,m,d,h,a,c,v,f;return{c(){t=p("div"),l=p("div"),n=p("form"),o=p("div"),r=p("div"),r.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-5"><path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"></path></svg>`,i=C(),s=p("input"),m=C(),d=p("div"),h=p("div"),h.textContent="Press ⌘Space+Shift to toggle",a=C(),c=p("button"),c.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-3"><path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"></path></svg>`,u(r,"class","tlwd-flex tlwd-items-center"),u(s,"id","open-webui-search-input"),u(s,"placeholder","Search Open WebUI"),u(s,"class","tlwd-p-0 tlwd-m-0 tlwd-text-xl tlwd-w-full tlwd-font-medium tlwd-bg-transparent tlwd-border-none placeholder:tlwd-text-gray-500 tlwd-text-neutral-100 tlwd-outline-none"),u(s,"autocomplete","one-time-code"),u(o,"class","tlwd-flex tlwd-items-center tlwd-gap-2 tlwd-w-full"),u(h,"class","tlwd-text-right tlwd-text-[0.7rem] tlwd-p-0 tlwd-m-0 tlwd-text-neutral-300 tlwd-h-fit"),u(c,"class","tlwd-h-fit tlwd-flex tlwd-items-center tlwd-bg-transparent tlwd-text-neutral-100 tlwd-cursor-pointer tlwd-p-0 tlwd-m-0 tlwd-outline-none tlwd-border-none"),u(c,"type","button"),u(d,"class","tlwd-flex tlwd-justify-end tlwd-gap-1 tlwd-items-center"),u(n,"class","tlwd-text-gray-200 tlwd-w-full tlwd-p-0 tlwd-m-0"),u(n,"autocomplete","off"),u(l,"class","tlwd-w-full tlwd-flex tlwd-flex-col tlwd-justify-between tlwd-py-2.5 tlwd-px-3.5 tlwd-rounded-2xl tlwd-outline tlwd-outline-1 tlwd-outline-gray-850 tlwd-backdrop-blur-3xl tlwd-bg-gray-850/70 shadow-4xl modal-animation"),u(t,"class","tlwd-m-auto tlwd-max-w-xl tlwd-w-full tlwd-pb-32")},m(x,E){L(x,t,E),w(t,l),w(l,n),w(n,o),w(o,r),w(o,i),w(o,s),S(s,e[4]),w(n,m),w(n,d),w(d,h),w(d,a),w(d,c),v||(f=[M(s,"input",e[13]),M(c,"click",e[14]),M(n,"submit",e[7]),M(n,"mousedown",$e)],v=!0)},p(x,E){E&16&&s.value!==x[4]&&S(s,x[4])},d(x){x&&I(t),v=!1,T(f)}}}function Be(e){let t,l,n,o,r,i,s,m,d,h,a,c,v,f,x,E,F,b=e[5]&&e[5].length>0&&te(e);return{c(){t=p("div"),l=p("div"),n=p("form"),o=p("div"),r=p("div"),r.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244"></path></svg>`,i=C(),s=p("input"),m=C(),d=p("div"),h=p("div"),h.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25Z"></path></svg>`,a=C(),c=p("input"),v=C(),f=p("button"),f.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"></path></svg>`,x=C(),b&&b.c(),u(r,"class","tlwd-flex tlwd-items-center"),u(s,"id","open-webui-url-input"),u(s,"placeholder","Open WebUI URL"),u(s,"class","tlwd-p-0 tlwd-m-0 tlwd-text-xl tlwd-w-full tlwd-font-medium tlwd-bg-transparent tlwd-border-none placeholder:tlwd-text-gray-500 tlwd-text-neutral-100 tlwd-outline-none"),u(s,"autocomplete","one-time-code"),s.required=!0,u(o,"class","tlwd-flex tlwd-items-center tlwd-gap-2 tlwd-w-full"),u(h,"class","tlwd-flex tlwd-items-center"),u(c,"placeholder","Open WebUI API Key"),u(c,"class","tlwd-p-0 tlwd-m-0 tlwd-text-xl tlwd-w-full tlwd-font-medium tlwd-bg-transparent tlwd-border-none placeholder:tlwd-text-gray-500 tlwd-text-neutral-100 tlwd-outline-none"),u(c,"autocomplete","one-time-code"),c.required=!0,u(f,"class","tlwd-flex tlwd-items-center tlwd-bg-transparent tlwd-text-neutral-100 tlwd-cursor-pointer tlwd-p-0 tlwd-m-0 tlwd-outline-none tlwd-border-none"),u(f,"type","button"),u(d,"class","tlwd-flex tlwd-items-center tlwd-gap-2 tlwd-w-full tlwd-mt-2"),u(n,"class","tlwd-text-gray-200 tlwd-w-full tlwd-p-0 tlwd-m-0"),u(n,"autocomplete","off"),u(l,"class","tlwd-w-full tlwd-flex tlwd-flex-col tlwd-justify-between tlwd-py-2.5 tlwd-px-3.5 tlwd-rounded-2xl tlwd-outline tlwd-outline-1 tlwd-outline-gray-850 tlwd-backdrop-blur-3xl tlwd-bg-gray-850/70 shadow-4xl modal-animation"),u(t,"class","tlwd-m-auto tlwd-max-w-sm tlwd-w-full tlwd-pb-32")},m(k,g){L(k,t,g),w(t,l),w(l,n),w(n,o),w(o,r),w(o,i),w(o,s),S(s,e[2]),w(n,m),w(n,d),w(d,h),w(d,a),w(d,c),S(c,e[3]),w(d,v),w(d,f),w(n,x),b&&b.m(n,null),E||(F=[M(s,"input",e[9]),M(c,"input",e[10]),M(f,"click",e[11]),M(n,"submit",e[8]),M(n,"mousedown",Pe)],E=!0)},p(k,g){g&4&&s.value!==k[2]&&S(s,k[2]),g&8&&c.value!==k[3]&&S(c,k[3]),k[5]&&k[5].length>0?b?b.p(k,g):(b=te(k),b.c(),b.m(n,null)):b&&(b.d(1),b=null)},d(k){k&&I(t),b&&b.d(),E=!1,T(F)}}}function te(e){let t,l,n,o,r,i,s,m,d,h=J(e[5]),a=[];for(let c=0;c<h.length;c+=1)a[c]=le(X(e,h,c));return{c(){t=p("div"),l=p("div"),l.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M20.25 6.375c0 2.278-3.694 4.125-8.25 4.125S3.75 8.653 3.75 6.375m16.5 0c0-2.278-3.694-4.125-8.25-4.125S3.75 4.097 3.75 6.375m16.5 0v11.25c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125V6.375m16.5 0v3.75m-16.5-3.75v3.75m16.5 0v3.75C20.25 16.153 16.556 18 12 18s-8.25-1.847-8.25-4.125v-3.75m16.5 0c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125"></path></svg>`,n=C(),o=p("select"),r=p("option"),r.textContent="Select a model";for(let c=0;c<a.length;c+=1)a[c].c();i=C(),s=p("button"),s.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-5"><path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5"></path></svg>`,u(l,"class","tlwd-flex tlwd-items-center"),r.__value="",S(r,r.__value),u(o,"id","open-webui-model-input"),u(o,"class","tlwd-p-0 tlwd-m-0 tlwd-text-xl tlwd-w-full tlwd-font-medium tlwd-bg-transparent tlwd-border-none placeholder:tlwd-text-gray-500 tlwd-text-neutral-100 tlwd-outline-none"),u(o,"autocomplete","off"),o.required=!0,e[6]===void 0&&z(()=>e[12].call(o)),u(s,"class","tlwd-flex tlwd-items-center tlwd-bg-transparent tlwd-text-neutral-100 tlwd-cursor-pointer tlwd-p-0 tlwd-m-0 tlwd-outline-none tlwd-border-none"),u(s,"type","submit"),u(t,"class","tlwd-flex tlwd-items-center tlwd-gap-2 tlwd-w-full tlwd-mt-2")},m(c,v){L(c,t,v),w(t,l),w(t,n),w(t,o),w(o,r);for(let f=0;f<a.length;f+=1)a[f]&&a[f].m(o,null);Z(o,e[6],!0),w(t,i),w(t,s),m||(d=M(o,"change",e[12]),m=!0)},p(c,v){if(v&32){h=J(c[5]);let f;for(f=0;f<h.length;f+=1){const x=X(c,h,f);a[f]?a[f].p(x,v):(a[f]=le(x),a[f].c(),a[f].m(o,null))}for(;f<a.length;f+=1)a[f].d(1);a.length=h.length}v&96&&Z(o,c[6])},d(c){c&&I(t),he(a,c),m=!1,d()}}}function le(e){let t,l=(e[6].name??e[6].id)+"",n,o;return{c(){t=p("option"),n=V(l),t.__value=o=e[6].id,S(t,t.__value)},m(r,i){L(r,t,i),w(t,n)},p(r,i){i&32&&l!==(l=(r[6].name??r[6].id)+"")&&ye(n,l),i&32&&o!==(o=r[6].id)&&(t.__value=o,S(t,t.__value))},d(r){r&&I(t)}}}function Te(e){let t,l=e[0]&&ee(e);return{c(){l&&l.c(),t=ge()},m(n,o){l&&l.m(n,o),L(n,t,o)},p(n,[o]){n[0]?l?l.p(n,o):(l=ee(n),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},i:B,o:B,d(n){n&&I(t),l&&l.d(n)}}}const Pe=e=>{e.stopPropagation()},$e=e=>{e.stopPropagation()};function He(e,t,l){let n=!1,o=!0,r="",i="",s="",m="",d=[];const h=()=>{console.log("resetConfig");try{chrome.storage.local.clear().then(()=>{console.log("Value is cleared")})}catch(g){console.log(g),localStorage.setItem("url",""),localStorage.setItem("key",""),localStorage.setItem("model","")}l(2,r=""),l(3,i=""),l(6,s=""),l(5,d=[]),l(1,o=!0)},a=g=>{g.preventDefault(),window.open(`${r}/?q=${encodeURIComponent(m)}&models=${s}`,"_blank"),l(4,m=""),l(0,n=!1)},c=g=>{g.preventDefault();try{chrome.storage.local.set({url:r,key:i,model:s}).then(()=>{console.log("Value is set")})}catch(K){console.log(K),localStorage.setItem("url",r),localStorage.setItem("key",i),localStorage.setItem("model",s)}l(1,o=!1)};xe(async()=>{let g=null;try{g=await chrome.storage.local.get()}catch(y){console.log(y)}g&&(l(2,r=g.url??""),l(3,i=g.key??""),l(6,s=g.model??""),g.url&&g.key&&g.model&&(l(5,d=await Q(g.key,g.url).catch(y=>{console.log(y),h()})),d&&l(1,o=!1)));const K=async y=>{var R;if(n&&y.shiftKey&&y.key==="Escape"?h():y.key==="Escape"&&l(0,n=!1),y.key===" "&&(y.metaKey||y.ctrlKey)&&(y.shiftKey||y.altKey)){console.log("🔧 Search shortcut triggered"),y.preventDefault();try{const _=await chrome.runtime.sendMessage({action:"getSelection"});((_==null?void 0:_.data)??!1)&&l(4,m=_.data)}catch(_){console.log("catch",_)}l(0,n=!n),setTimeout(()=>{const _=document.getElementById("open-webui-search-input");_&&_.focus()},0)}if(i!==""&&r!==""&&y.key==="Enter"&&(y.metaKey||y.ctrlKey)&&(y.shiftKey||y.altKey)){y.preventDefault();try{console.log("🔧 Direct completion triggered");const _=await chrome.runtime.sendMessage({action:"getSelection"});if(console.log("📝 Selected text:",_==null?void 0:_.data),(_==null?void 0:_.data)??!1){console.log("✅ Text selected, starting AI completion"),await chrome.runtime.sendMessage({action:"writeText",text:`
`}),console.log("🌐 Using background script for API call");const P=await chrome.runtime.sendMessage({action:"fetchCompletion",url:r,key:i,isOpenAI:((R=d.find(fe=>fe.id===s))==null?void 0:R.owned_by)==="openai",payload:{model:s,messages:[{role:"system",content:"You are a helpful assistant."},{role:"user",content:_.data}],stream:!0}});P.success?console.log("🚀 Background streaming started"):(console.error("❌ Background request failed:",P.error),await chrome.runtime.sendMessage({action:"writeText",text:`Error: ${P.error}`}))}else console.log("⚠️ No text selected"),await chrome.runtime.sendMessage({action:"writeText",text:"No text selected. Please select text first."})}catch(_){console.error("💥 Completion error:",_);try{await chrome.runtime.sendMessage({action:"writeText",text:`Error: ${_.message}`})}catch(P){console.error("Failed to send error message:",P)}}}};return document.addEventListener("keydown",K,{capture:!0}),()=>document.removeEventListener("keydown",K)});function v(){r=this.value,l(2,r)}function f(){i=this.value,l(3,i)}const x=async()=>{r.endsWith("/")&&l(2,r=r.slice(0,-1)),l(5,d=await Q(i,r))};function E(){s=ve(this),l(6,s),l(5,d)}function F(){m=this.value,l(4,m)}return[n,o,r,i,m,d,s,a,c,v,f,x,E,F,()=>{l(1,o=!0)},()=>{l(0,n=!1)}]}class Fe extends ae{constructor(t){super(),ue(this,t,He,Te,re,{})}}function Ke(e){let t,l,n;return l=new Fe({}),{c(){t=p("div"),Le(l.$$.fragment),u(t,"class","extension-container")},m(o,r){L(o,t,r),de(l,t,null),n=!0},p:B,i(o){n||(ie(l.$$.fragment,o),n=!0)},o(o){Ie(l.$$.fragment,o),n=!1},d(o){o&&I(t),ce(l)}}}class Ne extends ae{constructor(t){super(),ue(this,t,null,Ke,re,{})}}new Ne({target:document.getElementById("extension-app")});
